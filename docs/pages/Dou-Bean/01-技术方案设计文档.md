# 慕课乐高技术方案设计文档 v1.0

### 1. 需求

[需求文档](https://www.yuque.com/books/share/af79538c-09eb-4ddd-bfb7-599816c233bf)

### 2. 项目设计

项目三大模块及用户使用权限:

- 编辑器模块: 运营人员、管理员
- H5 作品展示模块: 运营人员、普通用户
- 管理模块: 管理员
  采用前后端分离模式进行开发,为提升 H5 作品渲染性能,使用服务端渲染.

模块内容及拆分:

- 编辑器: 制作发布作品,保存模版,并能查看作品的浏览、分享等数据、管理账号作品及模板等.
- H5 作品页:用于显示作品,提高服务端渲染能力及用户体验.收集浏览和分享数据,发送到统计服务端.
- 管理模块:用于管理作品,紧急下架.用户管理,查看网站所有数据(用户数、浏览量、作品数量等)
  为了提高开发效率,所有数据使用同一个数据库,所有模块使用开发同一个公共组件库.

[架构设计图](\images\web架构设计图.jpg)

### 3. 数据结构

- <font color=red>数组-对象</font>结构(有序,引用)

```js
[
  {
    id: 1,
    name: title,
  },
  {
    id: 2,
    name: detail,
  },
];
```

- vux store 数据结构(优点:结构清晰)

```js
{
    work:{
        title:'',
        setting:{ // 预留页面设置

        },
        props:{ //body配置

        },
        components:[
            {
                id: 1,
                name: "title",
                tag: "text",
                attrs:{ //属性

                },
                content:"标签里的内容",
                children:[ //子元素

                ]
            },
            {
                id: 2,
                name:"detail",
            },
            ...
        ],
        activeComponentsId:'1', //当前选中组件

    }
}
```

### 4. 数据流转

核心：B 端、C 端、管理后台，共用一个数据库。

- 创建作品: 初始化一个 JSON 数据
- 保存作品：修改 JSON 数据
- 发布作品：修改一个标记，仅此而已
- C 端浏览作品：获取 JSON 数据，SSR 渲染页面
- 屏蔽作品：修改一个标记，C 端来判断

[数据流转](\images\数据流转.jpg)

### 5. 扩展

扩展组件

锁定、隐藏组件

页面配置
